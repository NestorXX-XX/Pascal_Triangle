<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Pascal's Triangle &amp; Combinatorial Tools (Simplified)</title>
    <!-- Load MathJax for LaTeX rendering -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <style>
      /* Basic style for the page */
      body { font-family: Arial, sans-serif; margin:20px; background:#f9f9f9; }
      h1 { text-align:center; }
      h2 { text-align:center; }
      .section { margin-bottom:40px; background:#fff; padding:15px; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
      .section h2 { border-bottom:2px solid #ddd; padding-bottom:5px; color:#333; }
      #triangleContainer { margin-top:20px; text-align:center; font-size:1.2em; line-height:1.8em; }
      .triangleRow { opacity:0; transition: opacity 1s ease-in; margin:5px 0; }
      .visible { opacity:1; }
      label { margin-right:5px; }
      input[type="number"], input[type="text"] { width:70px; margin-right:10px; }
      button { margin-top:10px; padding:8px 12px; font-size:1em; cursor:pointer; border:none; border-radius:4px; background:#007bff; color:#fff; }
      button:hover { background:#0056b3; }
      #combinationResult, #expansionResult { margin-top:15px; font-weight:bold; }
    </style>
  </head>
  <body>
    <!-- Main heading -->
    <h1>Pascal's Triangle &amp; Combinatorial Tools</h1>
    <h2><a href="placeholder" target="_blank">README.md</a></h2>

    <!-- Section 1: Pascal's Triangle -->
    <div class="section" id="pascalSection">
      <h2>Pascal's Triangle</h2>
      <label for="triangleRows">Rows:</label>
      <input type="number" id="triangleRows" min="1" value="10"><!-- Number of rows -->
      <br>
      <button id="displayTriangleBtn">Show Triangle</button><!-- Button to display triangle -->
      <div id="triangleContainer"></div><!-- Where the triangle appears -->
    </div>

    <!-- Section 2: Combinatorial Calculator -->
    <div class="section" id="combinatoricsSection">
      <h2>Combinatorial Calculator</h2>
      <label for="nValue">n:</label>
      <input type="number" id="nValue" min="0" value="10"><!-- Input for n -->
      <label for="kValue">k:</label>
      <input type="number" id="kValue" min="0" value="3"><!-- Input for k -->
      <br>
      <button id="calculateCombinationBtn">Calc nCk</button><!-- Button to calculate nCk -->
      <div id="combinationResult"></div><!-- Where the result is shown -->
    </div>

    <!-- Section 3: Binomial Expansion with Simplification -->
    <div class="section" id="expansionSection">
      <h2>Binomial Expansion (Simplified)</h2>
      <label for="expansionExponent">n:</label>
      <input type="number" id="expansionExponent" min="0" value="3"><!-- Exponent for expansion -->
      <br>
      <label for="varA">A:</label>
      <input type="text" id="varA" value="x^2"><!-- First term (e.g., x^2) -->
      <label for="varB">B:</label>
      <input type="text" id="varB" value="1/x"><!-- Second term (e.g., 1/x) -->
      <br>
      <button id="expandBinomialBtn">Expand (A+B)^n</button><!-- Button to expand -->
      <div id="expansionResult" style="margin-top:15px; font-size:1.2em;"></div><!-- Where the expansion is rendered -->
    </div>

    <script>
      // Returns the nth row of Pascal's Triangle as an array.
      function getPascalRow(n) {
        let row = [1]; // First element is 1.
        for (let k = 1; k <= n; k++) { // Loop to compute rest of the row.
          row.push(row[k - 1] * (n - k + 1) / k); // Use recursive formula.
        }
        return row;
      }

      // Display Pascal's Triangle row by row with fade-in.
      document.getElementById('displayTriangleBtn').addEventListener('click', function() {
        const container = document.getElementById('triangleContainer'); // Get display container.
        container.innerHTML = ''; // Clear old content.
        let totalRows = parseInt(document.getElementById('triangleRows').value, 10); // Get number of rows.
        let currentRow = 0; // Start at row 0.
        function addRow() { // Function to add one row.
          if (currentRow >= totalRows) return; // Stop if done.
          let rowData = getPascalRow(currentRow); // Get row data.
          let rowDiv = document.createElement('div'); // Create a new div.
          rowDiv.className = 'triangleRow'; // Set CSS class.
          rowDiv.textContent = rowData.join(' '); // Set row text.
          container.appendChild(rowDiv); // Add row to container.
          setTimeout(() => rowDiv.classList.add('visible'), 100); // Fade in.
          currentRow++; // Increment row.
          setTimeout(addRow, 1000); // Add next row after 1 sec.
        }
        addRow(); // Start adding rows.
      });

      // Simple factorial function.
      function factorial(n) {
        if (n === 0 || n === 1) return 1; // Base case.
        let res = 1; // Start at 1.
        for (let i = 2; i <= n; i++) res *= i; // Multiply from 2 to n.
        return res; // Return result.
      }

      // Return binomial coefficient (nCk).
      function combination(n, k) {
        if (k < 0 || k > n) return 0; // Check bounds.
        return factorial(n) / (factorial(k) * factorial(n - k)); // Calculate nCk.
      }

      // Event for combinatorial calculator button.
      document.getElementById('calculateCombinationBtn').addEventListener('click', function() {
        let n = parseInt(document.getElementById('nValue').value, 10); // Get n.
        let k = parseInt(document.getElementById('kValue').value, 10); // Get k.
        document.getElementById('combinationResult').textContent = `C(${n},${k}) = ${combination(n, k)}`; // Show result.
      });

      // Parse a string like "x^2" or "1/x" into {base, exponent}.
      function parseSingleVar(str) {
        str = str.trim(); // Remove extra spaces.
        let m = str.match(/^1\/([a-zA-Z]+)(\^(-?\d+))?$/); // Check pattern for "1/x" or "1/x^m".
        if (m) return { base: m[1], exponent: m[3] ? -parseInt(m[3], 10) : -1 };
        m = str.match(/^([a-zA-Z]+)(\^(-?\d+))?$/); // Check pattern for "x" or "x^m".
        if (m) return { base: m[1], exponent: m[3] ? parseInt(m[3], 10) : 1 };
        return null; // Return null if pattern not matched.
      }

      // Expand (A+B)^n; if A and B share the same base, simplify the exponents.
      function expandBinomialLatex(n, rawA, rawB) {
        const parsedA = parseSingleVar(rawA); // Try to parse A.
        const parsedB = parseSingleVar(rawB); // Try to parse B.
        // If both parsed and have same base, simplify.
        if (parsedA && parsedB && parsedA.base === parsedB.base) {
          return expandSingleBase(n, parsedA, parsedB);
        } else {
          return expandGeneric(n, rawA, rawB); // Else use generic expansion.
        }
      }

      // Expand (x^a + x^b)^n when both terms share the same base.
      function expandSingleBase(n, A, B) {
        let terms = []; // Array to hold each term.
        for (let k = 0; k <= n; k++) { // Loop over k.
          let coeff = combination(n, k); // Binomial coefficient.
          let exp = A.exponent * (n - k) + B.exponent * k; // Combine exponents.
          let term = (coeff !== 1 || exp === 0 ? coeff : ''); // Include coeff if needed.
          if (exp !== 0) { // Add variable if exponent is not 0.
            term += (term ? ' \\cdot ' : '') + (exp === 1 ? A.base : `${A.base}^{${exp}}`);
          }
          if (term === '') term = '1'; // If term empty, use 1.
          terms.push(term); // Add term to list.
        }
        return terms.join(' + '); // Return joined terms.
      }

      // Generic expansion without exponent simplification.
      function expandGeneric(n, rawA, rawB) {
        // Parenthesize if needed (if string has ^ or / or >1 char).
        const paren = s => /[\^\/]/.test(s) || s.length > 1 ? `\\left(${s}\\right)` : s;
        let A = paren(rawA), B = paren(rawB), terms = [];
        for (let k = 0; k <= n; k++) {
          let coeff = combination(n, k);
          let aExp = n - k, bExp = k, factors = [];
          if (coeff !== 1 || (aExp === 0 && bExp === 0)) factors.push(coeff);
          if (aExp > 0) factors.push(aExp === 1 ? A : `${A}^{${aExp}}`);
          if (bExp > 0) factors.push(bExp === 1 ? B : `${B}^{${bExp}}`);
          terms.push(factors.join(' \\cdot '));
        }
        return terms.join(' + ');
      }

      // Event for the binomial expansion button.
      document.getElementById('expandBinomialBtn').addEventListener('click', function() {
        let n = parseInt(document.getElementById('expansionExponent').value, 10); // Get exponent.
        let A = document.getElementById('varA').value || 'x'; // Get term A.
        let B = document.getElementById('varB').value || '1'; // Get term B.
        let latex = `$$(${A} + ${B})^{${n}} = ${expandBinomialLatex(n, A, B)}$$`; // Build LaTeX string.
        let resultDiv = document.getElementById('expansionResult'); // Get result div.
        resultDiv.innerHTML = latex; // Insert LaTeX.
        if (window.MathJax) MathJax.typesetPromise([resultDiv]); // Render via MathJax.
      });
    </script>
  </body>
</html>